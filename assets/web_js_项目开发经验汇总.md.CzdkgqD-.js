import{_ as a,c as s,o as e,a3 as n}from"./chunks/framework.C5U8cnJv.js";const t="/xhh-blog/assets/image-4.B0FQMlmC.png",p="/xhh-blog/assets/image-5.DkQ3oLRl.png",b=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"web/js/项目开发经验汇总.md","filePath":"web/js/项目开发经验汇总.md"}'),i={name:"web/js/项目开发经验汇总.md"},l=n('<h3 id="每次打开页面图片视频资源很耗流量-有没有办法解决" tabindex="-1">每次打开页面图片视频资源很耗流量，有没有办法解决？ <a class="header-anchor" href="#每次打开页面图片视频资源很耗流量-有没有办法解决" aria-label="Permalink to &quot;每次打开页面图片视频资源很耗流量，有没有办法解决？&quot;">​</a></h3><h4 id="图片" tabindex="-1">图片： <a class="header-anchor" href="#图片" aria-label="Permalink to &quot;图片：&quot;">​</a></h4><p>浏览器强缓存</p><p><img src="'+t+`" alt="alt text"></p><h4 id="视频" tabindex="-1">视频： <a class="header-anchor" href="#视频" aria-label="Permalink to &quot;视频：&quot;">​</a></h4><p>2.1 range请求头</p><p>Range: bytes=0-1024</p><p>如果服务器支持范围请求，它会以状态码206 Partial Content响应，并在消息体中包含指定范围的内容。</p><p>这种请求方式通常不支持强制缓存，因为Range请求的设计初衷是为了提高网络传输效率，允许客户端只加载视频的一部分，而不是整个视频文件。</p><p>2.2 完整文件请求</p><h3 id="前端获取当前时间-不同时区时间不一样如何统一" tabindex="-1">前端获取当前时间，不同时区时间不一样如何统一？ <a class="header-anchor" href="#前端获取当前时间-不同时区时间不一样如何统一" aria-label="Permalink to &quot;前端获取当前时间，不同时区时间不一样如何统一？&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>let moment = require(&#39;moment-timezone&#39;)</span></span>
<span class="line"><span>moment.tz(date, &#39;Asia/Shanghai&#39;).format(&#39;YYYY-MM-DD HH:mm:ss&#39;) // 统一为北京时间（东八区）</span></span></code></pre></div><h3 id="后台通过aes加密-前端通过aes解密-加密过后的特殊字符含有-号的无法正确解密" tabindex="-1">后台通过aes加密，前端通过aes解密，加密过后的特殊字符含有“+”号的无法正确解密？ <a class="header-anchor" href="#后台通过aes加密-前端通过aes解密-加密过后的特殊字符含有-号的无法正确解密" aria-label="Permalink to &quot;后台通过aes加密，前端通过aes解密，加密过后的特殊字符含有“+”号的无法正确解密？&quot;">​</a></h3><p>浏览器会把url中的+转为空格，导致解密失败。</p><p>解决办法：</p><ol><li><p>服务端把将“+”号转义为“%2B”，前端就可以把%2B解析为+了；</p></li><li><p>使用base64编解码，不会出现+特殊字符。</p></li></ol><h3 id="canvas-获取-video-视频第一帧做为封面图-偶现封面图加载不出来" tabindex="-1">canvas 获取 video 视频第一帧做为封面图，偶现封面图加载不出来? <a class="header-anchor" href="#canvas-获取-video-视频第一帧做为封面图-偶现封面图加载不出来" aria-label="Permalink to &quot;canvas 获取 video 视频第一帧做为封面图，偶现封面图加载不出来?&quot;">​</a></h3><p>代码如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const videoEle = document.createElement(&#39;video&#39;)</span></span>
<span class="line"><span>videoEle.src = video</span></span>
<span class="line"><span>videoEle.crossOrigin = &#39;anonymous&#39;</span></span>
<span class="line"><span>videoEle.currentTime = 1</span></span>
<span class="line"><span>videoEle.oncanplay = () =&gt; {</span></span>
<span class="line"><span>    const canvas = document.createElement(&#39;canvas&#39;)</span></span>
<span class="line"><span>    canvas.width = 80</span></span>
<span class="line"><span>    canvas.height = 80</span></span>
<span class="line"><span>    canvas.getContext(&#39;2d&#39;).drawImage(videoEle, 0, 0, canvas.width, canvas.height)</span></span>
<span class="line"><span>    const previewImgSrc = canvas.toDataURL(&#39;image/png&#39;)</span></span>
<span class="line"><span>    console.log(previewImgSrc) // 封面图</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>比较大的视频(时长30min左右)会偶现封面图加载不出来的情况。</p><p>把视频时间从1改成0.9，未复现以上问题：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>videoEle.currentTime = 0.9</span></span></code></pre></div><h3 id="从cdn获取视频地址控制台有报错-net-err-failed-206-partial-content" tabindex="-1">从CDN获取视频地址控制台有报错 net::ERR_FAILED 206 (Partial Content) ？ <a class="header-anchor" href="#从cdn获取视频地址控制台有报错-net-err-failed-206-partial-content" aria-label="Permalink to &quot;从CDN获取视频地址控制台有报错 net::ERR_FAILED 206 (Partial Content) ？&quot;">​</a></h3><p><img src="`+p+`" alt="alt text"></p><p>报错如图，但是视频可以播放。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const videoEle = document.createElement(&#39;video&#39;)</span></span>
<span class="line"><span>videoEle.src = videoUrl</span></span>
<span class="line"><span>// 会进入 error 事件</span></span>
<span class="line"><span>videoEle.onerror = (e) =&gt; {</span></span>
<span class="line"><span>    console.log(&#39;error&#39;, e)</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>可能的解决办法：修改 nginx 缓存大小。</p>`,27),o=[l];function c(r,d,h,m,v,g){return e(),s("div",null,o)}const _=a(i,[["render",c]]);export{b as __pageData,_ as default};
