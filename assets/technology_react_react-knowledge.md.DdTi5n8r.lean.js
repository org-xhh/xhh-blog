import{_ as t,D as i,c,j as a,a as s,I as p,w as e,a3 as l,o}from"./chunks/framework.C5U8cnJv.js";const r="/xhh-blog/assets/image-4.eXpBAonZ.png",d="data:image/png;base64,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",u="/xhh-blog/assets/image-19.IKC96q5c.png",h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAAqCAYAAAAzikzDAAACm0lEQVRoBe2az0rDQBDG5w28+BIFn8CL71HwafQkvXgUrx71IvQZxIPgTUToUQ8KVVDE2nbkSzphXTcmabbZKZ2FsCZud7/55dvJ5g+xlvIw4B4RExH3L7WIiqeD4nVlPf1HwED/Ryfi/wrQt8cTvtj75NPtDz7Z6mbDWBgTY7cpKbT7jKpiobfRPAvW/2HX+wAOLU2KFu0+q1AshIN+w1T70NKkaNLuM/NjIb9B6v26aQTtUmutGt+NRR1o3wllDtfsZjkBbizqQOOiUqd0edEWcE1rNxZ1oBFMndI06FTtJRYDveKlrIFeMWCZQQbaQC9y9GU/e8CEh0z51uPBg/iD1S/t1sTRQ+7Tb7Cjo96vJ3sSiPZarLFGF8MRD3aIaX+YadcOWPQZaMvRZetopBPi3tFoJY6+u2cen8V/arlmjl6kDSdvy9SMVRtozp3sv+KKBVj62WjQstIgx8kyFQVQq/psJt159YzvIuVw6bjlquObx9IT6tcpX0UQiK4KyItVhjsM/m4FOKBxMx29eCMuFz4fsoEOOGUZ5+Vu7nO+Yg5hNkdHmdJF2ihuv+U2HHV+x7jMCUzxG7FJyxwdf90JGHVKCmjLjCmxGOhI6a7sJBjoFQMW8AZ600G7LzTFDaHaXs62dMr5br2PaNBOpqfW2o1F3cXw5rDed3hopxWw6HJjIU3OgJbJcyhR/D2Gdpq0C1yp/Vjo5XquQjCEQcv0/S/U0BG006Jd4EodioXgjK9H5puDSQa8y4sMxoIojA0Ndd0s4FNqF6hSV8VC82keIAJNuQEatDQpWrT73EKxFB+iYypmDnnqEPhTPmbddFF2EpJo941ZEUsBuiwIOx6HgIGOw7GyFwNdiShOAwMdh2NlLwa6ElGcBj/AnjEnGzfqSAAAAABJRU5ErkJggg==",g="/xhh-blog/assets/image-2.CFFrttEG.png",m="/xhh-blog/assets/image-3.vJHmhZI9.png",b="data:image/png;base64,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",v="/xhh-blog/assets/image-1.OTJ3BYfO.png",E=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"technology/react/react-knowledge.md","filePath":"technology/react/react-knowledge.md"}'),f={name:"technology/react/react-knowledge.md"},k=l(`<h2 id="项目环境" tabindex="-1">项目环境 <a class="header-anchor" href="#项目环境" aria-label="Permalink to &quot;项目环境&quot;">​</a></h2><table tabindex="0"><thead><tr><th>模块</th><th>版本</th></tr></thead><tbody><tr><td>node</td><td>18+</td></tr><tr><td>react</td><td>18+</td></tr><tr><td>react-dom</td><td>18+</td></tr><tr><td>react-router-dom</td><td>6+</td></tr><tr><td>react-redux</td><td>9+</td></tr><tr><td>@reduxjs/toolkit</td><td>2+</td></tr></tbody></table><h2 id="配置路由" tabindex="-1">配置路由 <a class="header-anchor" href="#配置路由" aria-label="Permalink to &quot;配置路由&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i react-router-dom@6</span></span></code></pre></div><h4 id="新建路由" tabindex="-1">新建路由 <a class="header-anchor" href="#新建路由" aria-label="Permalink to &quot;新建路由&quot;">​</a></h4><p>router/index.tsx:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import React from &#39;react&#39;</span></span>
<span class="line"><span>import { createBrowserRouter } from &#39;react-router-dom&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import ManageLayout from &#39;../layouts/ManageLayout&#39;</span></span>
<span class="line"><span>import Home from &#39;../pages/Home&#39;</span></span>
<span class="line"><span>import Demo from &#39;../pages/Demo&#39;</span></span>
<span class="line"><span>import NotFound from &#39;../pages/NotFound&#39;</span></span>
<span class="line"><span>import ManageList from &#39;../pages/manage/List&#39;</span></span>
<span class="line"><span>import ManageEdit from &#39;../pages/manage/Edit&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const router = createBrowserRouter([</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    path: &#39;/&#39;,</span></span>
<span class="line"><span>    element: &lt;ManageLayout /&gt;,</span></span>
<span class="line"><span>    children: [</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        path: &#39;/&#39;,</span></span>
<span class="line"><span>        element: &lt;Home /&gt;</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        path: &#39;demo&#39;,</span></span>
<span class="line"><span>        element: &lt;Demo /&gt;</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    path: &#39;manage&#39;,</span></span>
<span class="line"><span>    children: [</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        path: &#39;list&#39;,</span></span>
<span class="line"><span>        element: &lt;ManageList /&gt;</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        path: &#39;edit/:id&#39;,</span></span>
<span class="line"><span>        element: &lt;ManageEdit /&gt;</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    path: &#39;*&#39;, // 以上路由都没有命中，写在最后</span></span>
<span class="line"><span>    element: &lt;NotFound /&gt;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default router</span></span></code></pre></div><h4 id="注册路由" tabindex="-1">注册路由 <a class="header-anchor" href="#注册路由" aria-label="Permalink to &quot;注册路由&quot;">​</a></h4><p>App.tsx:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { RouterProvider } from &#39;react-router-dom&#39;</span></span>
<span class="line"><span>import routerConfig from &#39;./router&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return (</span></span>
<span class="line"><span>  &lt;RouterProvider router={routerConfig}&gt;&lt;/RouterProvider&gt;</span></span>
<span class="line"><span>)</span></span></code></pre></div><h2 id="路由鉴权" tabindex="-1">路由鉴权 <a class="header-anchor" href="#路由鉴权" aria-label="Permalink to &quot;路由鉴权&quot;">​</a></h2><p>authRouter.tsx:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { getToken } from &quot;@/utils/storage&quot;</span></span>
<span class="line"><span>import { Navigate, useLocation } from &quot;react-router-dom&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>interface AuthRouteProps {</span></span>
<span class="line"><span>  children: React.ReactNode</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const AuthRoute: React.FC&lt;AuthRouteProps&gt; = ({ children }) =&gt; {</span></span>
<span class="line"><span>  const hasToken = getToken()</span></span>
<span class="line"><span>  const location = useLocation() // 获取url信息</span></span>
<span class="line"><span>  if (hasToken) {</span></span>
<span class="line"><span>    if (location.pathname === &#39;/login&#39;) {</span></span>
<span class="line"><span>      return &lt;Navigate to=&quot;/&quot; replace /&gt;</span></span>
<span class="line"><span>    } else {</span></span>
<span class="line"><span>      return &lt;&gt;{children}&lt;/&gt;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  } else {</span></span>
<span class="line"><span>    // 未登录</span></span>
<span class="line"><span>    if (location.pathname === &#39;/login&#39;) {</span></span>
<span class="line"><span>      return &lt;&gt;{children}&lt;/&gt;</span></span>
<span class="line"><span>    } else {</span></span>
<span class="line"><span>      return &lt;Navigate to=&quot;/login&quot; replace /&gt;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default AuthRoute</span></span></code></pre></div><p>router/index.tsx:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { AuthRoute } from &#39;./authRoute.tsx&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  path: &#39;/article&#39;,</span></span>
<span class="line"><span>  element: &lt;AuthRoute&gt;&lt;Article /&gt;&lt;/AuthRoute&gt;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>优化，兼容不需要授权的路由：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const routes = [</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>]</span></span>
<span class="line"><span>import AuthRoute from &#39;./authRouter.tsx&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const authRoutes = (routes) =&gt; {</span></span>
<span class="line"><span>    return routes.map((item) =&gt; {</span></span>
<span class="line"><span>        if (item.needAuth) {</span></span>
<span class="line"><span>            return {</span></span>
<span class="line"><span>                path: item.path,</span></span>
<span class="line"><span>                element: (</span></span>
<span class="line"><span>                    &lt;AuthRoute&gt;</span></span>
<span class="line"><span>                        {item.element}</span></span>
<span class="line"><span>                    &lt;/AuthRoute&gt;</span></span>
<span class="line"><span>                )</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        } else {</span></span>
<span class="line"><span>            delete item.needAuth</span></span>
<span class="line"><span>            return item</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    })</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default authRoutes(routes)</span></span></code></pre></div><h2 id="路由-layout" tabindex="-1">路由 Layout <a class="header-anchor" href="#路由-layout" aria-label="Permalink to &quot;路由 Layout&quot;">​</a></h2><p>src/layouts/ManageLayout.tsx:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import React, { FC } from &#39;react&#39;</span></span>
<span class="line"><span>import { Outlet, Link } from &#39;react-router-dom&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const ManageLayout: FC = () =&gt; {</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div&gt;</span></span>
<span class="line"><span>      &lt;h1&gt;---ManageLayout header---&lt;/h1&gt;</span></span>
<span class="line"><span>      &lt;Link to=&quot;/&quot;&gt;home&lt;/Link&gt;</span></span>
<span class="line"><span>      &lt;Link to=&quot;/demo&quot;&gt;demo&lt;/Link&gt;</span></span>
<span class="line"><span>      &lt;div&gt;</span></span>
<span class="line"><span>        {/* 配置二级路由渲染位置 */}</span></span>
<span class="line"><span>        &lt;Outlet /&gt;</span></span>
<span class="line"><span>      &lt;/div&gt;</span></span>
<span class="line"><span>      &lt;h1&gt;---ManageLayout footer---&lt;/h1&gt;</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default ManageLayout</span></span></code></pre></div><p>router/index.tsx:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import ManageLayout from &#39;../layouts/ManageLayout&#39;</span></span>
<span class="line"><span>import Home from &#39;../pages/Home&#39;</span></span>
<span class="line"><span>import Demo from &#39;../pages/Demo&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const router = createBrowserRouter([</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    path: &#39;/&#39;,</span></span>
<span class="line"><span>    element: &lt;ManageLayout /&gt;,</span></span>
<span class="line"><span>    children: [</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        // 这样写打开/ 无法渲染出二级路由(跳转时 /home)</span></span>
<span class="line"><span>        // path: &#39;home&#39;,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        path: &#39;/&#39;,</span></span>
<span class="line"><span>        // or</span></span>
<span class="line"><span>        index: true, // 默认二级路由页面,打开/ 渲染出home</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        element: &lt;Home /&gt;</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        path: &#39;demo&#39;,</span></span>
<span class="line"><span>        element: &lt;Demo /&gt;</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>])</span></span></code></pre></div><p><img src="`+r+`" alt="alt text"></p><h2 id="路由懒加载" tabindex="-1">路由懒加载 <a class="header-anchor" href="#路由懒加载" aria-label="Permalink to &quot;路由懒加载&quot;">​</a></h2><p>路由的JS资源只有在被访问时才会动态获取，目的是为了优化项目首屏时间。</p><ul><li>React 提供的 lazy 函数进行动态导入</li><li>Suspense 组件包裹element路由</li></ul><p>之前：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import Login from &#39;../pages/Login/login&#39;</span></span>
<span class="line"><span>import Article from &#39;../pages/Article/article&#39;</span></span></code></pre></div><p>之后：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { Suspense, lazy } from &#39;react&#39;</span></span>
<span class="line"><span>const Login = lazy(() =&gt; import(&#39;../pages/Login/login&#39;))</span></span>
<span class="line"><span>const Article = lazy(() =&gt; import(&#39;../pages/Article/article&#39;))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  path: &#39;/login&#39;,</span></span>
<span class="line"><span>  element: &lt;Suspense fallback={&#39;加载中...&#39;}&gt;&lt;Login /&gt;&lt;/Suspense&gt;</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="路由传参" tabindex="-1">路由传参 <a class="header-anchor" href="#路由传参" aria-label="Permalink to &quot;路由传参&quot;">​</a></h2><h4 id="usesearchparams" tabindex="-1">useSearchParams <a class="header-anchor" href="#usesearchparams" aria-label="Permalink to &quot;useSearchParams&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useNavigate } from &#39;react-router-dom&#39;</span></span>
<span class="line"><span>const navigate = useNavigate()</span></span>
<span class="line"><span>// 跳转页面</span></span>
<span class="line"><span>function jumpPage() {</span></span>
<span class="line"><span>  // navigate(&#39;/demo?a=20&#39;)</span></span>
<span class="line"><span>  // navigate(&#39;/demo?a=20&#39;, { replace: true })</span></span>
<span class="line"><span>  // 或</span></span>
<span class="line"><span>  navigate({</span></span>
<span class="line"><span>    pathname: &#39;/demo&#39;,</span></span>
<span class="line"><span>    search: &#39;a=20&#39;</span></span>
<span class="line"><span>  }, {</span></span>
<span class="line"><span>    replace: false</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>  // navigate(-1) // 返回上一页</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 获取</span></span>
<span class="line"><span>import { useSearchParams } from &quot;react-router-dom&quot;</span></span>
<span class="line"><span>function Demo() {</span></span>
<span class="line"><span>    let [searchParams] = useSearchParams();</span></span>
<span class="line"><span>    console.log(searchParams.get(&#39;a&#39;))</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>}</span></span></code></pre></div><h4 id="useparams" tabindex="-1">useParams <a class="header-anchor" href="#useparams" aria-label="Permalink to &quot;useParams&quot;">​</a></h4><p>获取动态参数</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  path: &#39;manage&#39;,</span></span>
<span class="line"><span>  children: [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      path: &#39;list&#39;,</span></span>
<span class="line"><span>      element: &lt;ManageList /&gt;</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      path: &#39;edit/:id&#39;,</span></span>
<span class="line"><span>      element: &lt;ManageEdit /&gt;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;!-- 声明式导航 --&gt;</span></span>
<span class="line"><span>&lt;Link to=&quot;/manage/edit/666&quot;&gt;跳转到ManageEdit&lt;/Link&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>import React, { FC } from &#39;react&#39;</span></span>
<span class="line"><span>import { useParams } from &#39;react-router-dom&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const ManageEdit: FC = () =&gt; {</span></span>
<span class="line"><span>  const { id } = useParams()</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div&gt;</span></span>
<span class="line"><span>      &lt;h1&gt;ManageEdit - {id}&lt;/h1&gt;</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default ManageEdit</span></span></code></pre></div><h4 id="uselocation" tabindex="-1">useLocation <a class="header-anchor" href="#uselocation" aria-label="Permalink to &quot;useLocation&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 携带参数</span></span>
<span class="line"><span>&lt;Link to=&quot;/page1/111&quot; state={{txt:777}}&gt;go Page1&lt;/Link&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 获取</span></span>
<span class="line"><span>import { useLocation } from &quot;react-router-dom&quot;;</span></span>
<span class="line"><span>function Page1() {</span></span>
<span class="line"><span>  console.log(&#39;data:&#39;, useLocation().state.txt) // 777</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="别名路径配置" tabindex="-1">别名路径配置 <a class="header-anchor" href="#别名路径配置" aria-label="Permalink to &quot;别名路径配置&quot;">​</a></h2><h3 id="create-react-app" tabindex="-1">create-react-app <a class="header-anchor" href="#create-react-app" aria-label="Permalink to &quot;create-react-app&quot;">​</a></h3><p>CRA 本身把webpack配置包装到了黑盒里无法直接修改，需要借助一个插件：craco</p><ul><li>安装 craco</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i @craco/craco -D</span></span></code></pre></div><ul><li>项目根目录创建配置文件</li></ul><p>craco.config.js</p><ul><li>配置文件中添加路径解析配置(webpack)</li></ul><p>craco.config.js:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const path  = require(&#39;path&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>module.exports = {</span></span>
<span class="line"><span>  webpack: {</span></span>
<span class="line"><span>    alias: {</span></span>
<span class="line"><span>      &#39;@&#39;: path.resolve(__dirname, &#39;src&#39;),</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>}</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import sum from &#39;@/test&#39;</span></span></code></pre></div><ul><li>包文件中配置启动和打包命令</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&quot;scripts&quot;: {</span></span>
<span class="line"><span>  &quot;start&quot;: &quot;craco start&quot;,</span></span>
<span class="line"><span>  &quot;build&quot;: &quot;craco build&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><ul><li>路径联想配置(vscode)</li></ul><p>jsconfig.json:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>    &quot;compilerOptions&quot;: {</span></span>
<span class="line"><span>        &quot;baseUrl&quot;: &quot;./&quot;,</span></span>
<span class="line"><span>        &quot;paths&quot;: {</span></span>
<span class="line"><span>            &quot;@/*&quot;: [</span></span>
<span class="line"><span>                &quot;src/*&quot;</span></span>
<span class="line"><span>            ]</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>输入 &quot;@/&quot; vscode会给后面的路径提示</p><h3 id="vite" tabindex="-1">vite <a class="header-anchor" href="#vite" aria-label="Permalink to &quot;vite&quot;">​</a></h3><h4 id="路径解析" tabindex="-1">路径解析 <a class="header-anchor" href="#路径解析" aria-label="Permalink to &quot;路径解析&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { defineConfig } from &#39;vite&#39;</span></span>
<span class="line"><span>import react from &#39;@vitejs/plugin-react&#39;</span></span>
<span class="line"><span>import path from &#39;path&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// https://vite.dev/config/</span></span>
<span class="line"><span>export default defineConfig({</span></span>
<span class="line"><span>  plugins: [react()],</span></span>
<span class="line"><span>  resolve: {</span></span>
<span class="line"><span>    alias: {</span></span>
<span class="line"><span>      &#39;@&#39;: path.resolve(__dirname, &#39;./src&#39;),</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>})</span></span></code></pre></div><p>path模块 和 __dirname 标红，缺少类型声明，解决办法：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i @types/node -D</span></span></code></pre></div><h4 id="vscode路径提示" tabindex="-1">vscode路径提示 <a class="header-anchor" href="#vscode路径提示" aria-label="Permalink to &quot;vscode路径提示&quot;">​</a></h4><p>tsconfig.json添加配置：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;compilerOptions&quot;: {</span></span>
<span class="line"><span>    &quot;baseUrl&quot;: &quot;.&quot;,</span></span>
<span class="line"><span>    &quot;paths&quot;: {</span></span>
<span class="line"><span>      &quot;@/*&quot;: [&quot;src/*&quot;]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="样式使用" tabindex="-1">样式使用 <a class="header-anchor" href="#样式使用" aria-label="Permalink to &quot;样式使用&quot;">​</a></h2><h3 id="引入样式文件-使用类" tabindex="-1">引入样式文件，使用类 <a class="header-anchor" href="#引入样式文件-使用类" aria-label="Permalink to &quot;引入样式文件，使用类&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import &#39;./App.css&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div className=&quot;foo&quot;&gt;test&lt;/div&gt;</span></span></code></pre></div><h3 id="inline-样式" tabindex="-1">inline 样式 <a class="header-anchor" href="#inline-样式" aria-label="Permalink to &quot;inline 样式&quot;">​</a></h3><p>style 是对象形式,其中的key是驼峰式</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const divStyle: React.CSSProperties = {</span></span>
<span class="line"><span>  color: &#39;red&#39;,</span></span>
<span class="line"><span>  marginBottom: &#39;10px&#39;</span></span>
<span class="line"><span>};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return &lt;div style={divStyle}&gt;content&lt;/div&gt;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;div style={{ cursor: &#39;pointer&#39;,marginTop: &#39;50px&#39; }}&gt;</span></span>
<span class="line"><span>  内容</span></span>
<span class="line"><span>&lt;/div&gt;</span></span></code></pre></div><h3 id="使用-scss" tabindex="-1">使用 scss <a class="header-anchor" href="#使用-scss" aria-label="Permalink to &quot;使用 scss&quot;">​</a></h3><p>create-react-app 原生支持 sass module，只需要安装</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i sass -D</span></span></code></pre></div><h3 id="css-module" tabindex="-1">CSS Module <a class="header-anchor" href="#css-module" aria-label="Permalink to &quot;CSS Module&quot;">​</a></h3><p>解决className可能重复的问题； create-react-app 内置了对 CSS Module 的支持。</p><p>‌1.更改文件名 ‌</p><p>将 CSS 文件名从 styles.css 更改为 styles.module.css</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>.color-yellow {</span></span>
<span class="line"><span>  color: #FFF766;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>2.引入样式 ‌</p><p>在组件文件中，使用 ES6 模块语法引入样式文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import styles from &#39;./styles.module.css&#39;;</span></span></code></pre></div><p>‌3.使用样式 ‌</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;div className={styles[&#39;color-yellow&#39;]}&gt;</span></span></code></pre></div><h3 id="tailwind-css" tabindex="-1">Tailwind CSS <a class="header-anchor" href="#tailwind-css" aria-label="Permalink to &quot;Tailwind CSS&quot;">​</a></h3><h4 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm install tailwindcss@3 postcss autoprefixer -S</span></span></code></pre></div><h4 id="npx-tailwindcss-init" tabindex="-1">npx tailwindcss init <a class="header-anchor" href="#npx-tailwindcss-init" aria-label="Permalink to &quot;npx tailwindcss init&quot;">​</a></h4><p>执行命令后自动生成 tailwind.config.js 文件，编辑</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/** @type {import(&#39;tailwindcss&#39;).Config} */</span></span>
<span class="line"><span>module.exports = {</span></span>
<span class="line"><span>  content: [&quot;./src/**/*.{js,jsx,ts,tsx}&quot;],</span></span>
<span class="line"><span>  theme: {</span></span>
<span class="line"><span>    extend: {},</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  plugins: [],</span></span>
<span class="line"><span>}</span></span></code></pre></div><h4 id="项目样式文件引入-tailwindcss" tabindex="-1">项目样式文件引入 tailwindcss <a class="header-anchor" href="#项目样式文件引入-tailwindcss" aria-label="Permalink to &quot;项目样式文件引入 tailwindcss&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@tailwind base;</span></span>
<span class="line"><span>@tailwind components;</span></span>
<span class="line"><span>@tailwind utilities;</span></span></code></pre></div><h4 id="安装-types-tailwindcss" tabindex="-1">安装 @types/tailwindcss <a class="header-anchor" href="#安装-types-tailwindcss" aria-label="Permalink to &quot;安装 @types/tailwindcss&quot;">​</a></h4><p>在 TypeScript 中获得智能提示（比如自动完成和类型检查）</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm install @types/tailwindcss -D</span></span></code></pre></div><h4 id="新增-postcss-config-ts" tabindex="-1">新增 postcss.config.ts <a class="header-anchor" href="#新增-postcss-config-ts" aria-label="Permalink to &quot;新增 postcss.config.ts&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>module.exports = {</span></span>
<span class="line"><span>  plugins: {</span></span>
<span class="line"><span>    tailwindcss: {},</span></span>
<span class="line"><span>    autoprefixer: {},</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h4 id="组件中使用" tabindex="-1">组件中使用 <a class="header-anchor" href="#组件中使用" aria-label="Permalink to &quot;组件中使用&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>div className=&quot;flex&quot;&gt;</span></span>
<span class="line"><span>  &lt;p&gt;内容&lt;/p&gt;</span></span>
<span class="line"><span>  &lt;p className=&quot;flex-1&quot;&gt;显示&lt;/p&gt;</span></span>
<span class="line"><span>&lt;/div&gt;</span></span></code></pre></div><h2 id="jsx" tabindex="-1">JSX <a class="header-anchor" href="#jsx" aria-label="Permalink to &quot;JSX&quot;">​</a></h2><p>JSX是Javascript和XML(HTML)的缩写，表示在JS代码中编写HTML模板结构。 是JS的语法扩展，浏览器本身不能识别，需要通过解析工具解析之后才能在浏览器中运行。</p><p>通过大括号{}识别JavaScript中的表达式。</p><p>注意：if语句，switch语句，变量声明属于语句，不是表达式，不能出现在{}中。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 组件（函数）首字母必须大写</span></span>
<span class="line"><span>function App() {</span></span>
<span class="line"><span>  let list = [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      id:1,</span></span>
<span class="line"><span>      title: &#39;标题一&#39;</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      id: 2,</span></span>
<span class="line"><span>      title: &#39;标题二&#39;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>  let [isTure, setIsTure] = useState(true)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const valueDom: string = &#39;&lt;section style=&quot;color: red&quot;&gt;haha&lt;/section&gt;&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div className=&quot;App&quot;&gt;</span></span>
<span class="line"><span>      &lt;ul&gt;</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>          list.map((item) =&gt; {</span></span>
<span class="line"><span>            return &lt;li key={item.id}&gt;{item.title}&lt;/li&gt;</span></span>
<span class="line"><span>          })</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      &lt;/ul&gt;</span></span>
<span class="line"><span>      { isTure &amp;&amp; &lt;div&gt;ok&lt;/div&gt; }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      &lt;div dangerouslySetInnerHTML={{__html: valueDom }}&gt;&lt;/div&gt;</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default App;</span></span></code></pre></div><h3 id="动态类名" tabindex="-1">动态类名 <a class="header-anchor" href="#动态类名" aria-label="Permalink to &quot;动态类名&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;div className={\`nav \${isActive &amp;&amp; &#39;active&#39;}\`}&gt;</span></span></code></pre></div><p>或使用 classnames 库</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;div className={classnames(&#39;nav&#39;, {active: isActive})}&gt;</span></span></code></pre></div><h3 id="事件绑定" tabindex="-1">事件绑定 <a class="header-anchor" href="#事件绑定" aria-label="Permalink to &quot;事件绑定&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>function App() {</span></span>
<span class="line"><span>  function handleClick(e) {</span></span>
<span class="line"><span>    console.log(e.target.innerHTML)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  const handleClickButton = (params1, e)=&gt; {</span></span>
<span class="line"><span>    console.log(&#39;click button：&#39;, params1, e)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div className=&quot;App&quot;&gt;</span></span>
<span class="line"><span>      &lt;button onClick={handleClick}&gt;button&lt;/button&gt;</span></span>
<span class="line"><span>      &lt;button onClick={(e)=&gt;handleClickButton(&#39;Hi&#39;, e)}&gt;button&lt;/button&gt;</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default App;</span></span></code></pre></div><h2 id="状态管理-redux" tabindex="-1">状态管理 Redux <a class="header-anchor" href="#状态管理-redux" aria-label="Permalink to &quot;状态管理 Redux&quot;">​</a></h2><h3 id="独立使用的redux" tabindex="-1">独立使用的Redux <a class="header-anchor" href="#独立使用的redux" aria-label="Permalink to &quot;独立使用的Redux&quot;">​</a></h3>`,111),x=l(`<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// cdn 引入 redux 库</span></span>
<span class="line"><span>function reducer(state = {count: 0}, action) {</span></span>
<span class="line"><span>  // 数据不可变：基于原始状态生成一个新状态</span></span>
<span class="line"><span>  if (action.type === &#39;INCREMENT&#39;) {</span></span>
<span class="line"><span>    return {count: state.count + action.payload}</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  if (action.type === &#39;DECREMENT&#39;) {</span></span>
<span class="line"><span>    return {count: state.count - 1}</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  return state</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const store = Redux.createStore(reducer)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>store.subscribe(() =&gt; { </span></span>
<span class="line"><span>  console.log(&#39;state change&#39;)</span></span>
<span class="line"><span>  document.getElementById(&#39;count&#39;).innerHTML = store.getState().count</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function clickIncrement() {</span></span>
<span class="line"><span>  store.dispatch({</span></span>
<span class="line"><span>    type: &#39;INCREMENT&#39;,</span></span>
<span class="line"><span>    payload: 5</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>function clickDecrement() {</span></span>
<span class="line"><span>  store.dispatch({</span></span>
<span class="line"><span>    type: &#39;DECREMENT&#39;</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span>  &lt;button onClick={clickDecrement}&gt;-&lt;/button&gt;</span></span>
<span class="line"><span>  &lt;span id=&quot;count&quot;&gt;&lt;/span&gt;</span></span>
<span class="line"><span>  &lt;button onClick={clickIncrement}&gt;+&lt;/button&gt;</span></span>
<span class="line"><span>&lt;/div&gt;</span></span></code></pre></div><h3 id="react-中的-redux" tabindex="-1">React 中的 Redux <a class="header-anchor" href="#react-中的-redux" aria-label="Permalink to &quot;React 中的 Redux&quot;">​</a></h3><p>Redux 是 React 最常用的集中状态管理工具，可以独立于框架运行。</p><h4 id="安装-1" tabindex="-1">安装 <a class="header-anchor" href="#安装-1" aria-label="Permalink to &quot;安装&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm install @reduxjs/toolkit react-redux -S</span></span></code></pre></div><h4 id="_1-创建-redux-state-slice" tabindex="-1">1. 创建 Redux State Slice <a class="header-anchor" href="#_1-创建-redux-state-slice" aria-label="Permalink to &quot;1. 创建 Redux State Slice&quot;">​</a></h4><p>store/modules/counterStore.js:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { createSlice } from &#39;@reduxjs/toolkit&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export const counterSlice = createSlice({</span></span>
<span class="line"><span>  name: &#39;counter&#39;,</span></span>
<span class="line"><span>  initialState: {</span></span>
<span class="line"><span>    count: 0</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  reducers: {</span></span>
<span class="line"><span>    // 同步方法，支持直接修改</span></span>
<span class="line"><span>    increment: state =&gt; {</span></span>
<span class="line"><span>      state.count += 1</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    decrement: state =&gt; {</span></span>
<span class="line"><span>      state.count -= 1</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    incrementByAmount: (state, action) =&gt; {</span></span>
<span class="line"><span>      state.count += action.payload</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export const { increment, decrement, incrementByAmount } = counterSlice.actions</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default counterSlice.reducer</span></span></code></pre></div><h4 id="_2-将-slice-reducers-组合到-redux-store-中" tabindex="-1">2. 将 Slice Reducers 组合到 Redux Store 中 <a class="header-anchor" href="#_2-将-slice-reducers-组合到-redux-store-中" aria-label="Permalink to &quot;2. 将 Slice Reducers 组合到 Redux Store 中&quot;">​</a></h4><p>store/index.js:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { configureStore } from &#39;@reduxjs/toolkit&#39;</span></span>
<span class="line"><span>import counterReducer from &#39;./modules/counterStore&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default configureStore({</span></span>
<span class="line"><span>  reducer: {</span></span>
<span class="line"><span>    counter: counterReducer</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span></code></pre></div><h4 id="_3-将-store-实例注入到应用中" tabindex="-1">3. 将 store 实例注入到应用中 <a class="header-anchor" href="#_3-将-store-实例注入到应用中" aria-label="Permalink to &quot;3. 将 store 实例注入到应用中&quot;">​</a></h4><p>index.js:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import store from &#39;./store/index.js&#39;</span></span>
<span class="line"><span>import { Provider } from &#39;react-redux&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const root = ReactDOM.createRoot(document.getElementById(&#39;root&#39;));</span></span>
<span class="line"><span>root.render(</span></span>
<span class="line"><span>  &lt;React.StrictMode&gt;</span></span>
<span class="line"><span>    &lt;Provider store={store}&gt;</span></span>
<span class="line"><span>        &lt;App /&gt;</span></span>
<span class="line"><span>    &lt;/Provider&gt;</span></span>
<span class="line"><span>  &lt;/React.StrictMode&gt;</span></span>
<span class="line"><span>);</span></span></code></pre></div><h4 id="_4-在-react-组件中使用" tabindex="-1">4. 在 React 组件中使用 <a class="header-anchor" href="#_4-在-react-组件中使用" aria-label="Permalink to &quot;4. 在 React 组件中使用&quot;">​</a></h4><ul><li>useSelector 把 store 中的数据映射到组件中</li><li>useDispatch 生成提交 action 对象的 dispatch 函数</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useSelector, useDispatch } from &#39;react-redux&#39;</span></span>
<span class="line"><span>import { decrement, increment, incrementByAmount } from &#39;../store/modules/counterStore&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function Page2() {</span></span>
<span class="line"><span>  const { count } = useSelector(state =&gt; state.counter)</span></span>
<span class="line"><span>  const dispatch = useDispatch()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    return &lt;div&gt;</span></span>
<span class="line"><span>      &lt;main&gt;Welcome to Page2&lt;/main&gt;</span></span>
<span class="line"><span>      &lt;div&gt;{count}&lt;/div&gt;</span></span>
<span class="line"><span>      &lt;div&gt;</span></span>
<span class="line"><span>        &lt;button</span></span>
<span class="line"><span>          onClick={() =&gt; dispatch(increment())}</span></span>
<span class="line"><span>        &gt;</span></span>
<span class="line"><span>          Increment</span></span>
<span class="line"><span>        &lt;/button&gt;</span></span>
<span class="line"><span>        &lt;button</span></span>
<span class="line"><span>          onClick={() =&gt; dispatch(incrementByAmount(5))}</span></span>
<span class="line"><span>        &gt;</span></span>
<span class="line"><span>          Increment 5</span></span>
<span class="line"><span>        &lt;/button&gt;</span></span>
<span class="line"><span>        &lt;button</span></span>
<span class="line"><span>          onClick={() =&gt; dispatch(decrement())}</span></span>
<span class="line"><span>        &gt;</span></span>
<span class="line"><span>          Decrement</span></span>
<span class="line"><span>        &lt;/button&gt;</span></span>
<span class="line"><span>      &lt;/div&gt;</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default Page2;</span></span></code></pre></div><h4 id="页面效果" tabindex="-1">页面效果 <a class="header-anchor" href="#页面效果" aria-label="Permalink to &quot;页面效果&quot;">​</a></h4><p><img src="`+d+`" alt="alt text"></p><p>备注：chrome 插件 - Redux DevTools</p><h4 id="在-store-中使用异步操作" tabindex="-1">在 store 中使用异步操作： <a class="header-anchor" href="#在-store-中使用异步操作" aria-label="Permalink to &quot;在 store 中使用异步操作：&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>export const counterSlice = createSlice({</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  reducers: {</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    setCount(state, action) {</span></span>
<span class="line"><span>      state.count = action.payload</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>export const { ..., setCount } = counterSlice.actions</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export const fetchTestData = () =&gt; {</span></span>
<span class="line"><span>  return async (dispatch) =&gt; {</span></span>
<span class="line"><span>    const res = await axios(&#39;https://dev.test.shop/data&#39;)</span></span>
<span class="line"><span>    dispatch(setCount(res.data.num))</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>useEffect(() =&gt; {</span></span>
<span class="line"><span>  dispatch(fetchTestData())</span></span>
<span class="line"><span>}, [dispatch])</span></span></code></pre></div><h2 id="异步请求-axios" tabindex="-1">异步请求 axios <a class="header-anchor" href="#异步请求-axios" aria-label="Permalink to &quot;异步请求 axios&quot;">​</a></h2><p>安装</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i axios -S</span></span></code></pre></div><p>封装 utils/http.ts:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import axios from &#39;axios&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 创建axios实例</span></span>
<span class="line"><span>const service = axios.create({</span></span>
<span class="line"><span>  baseURL: &#39;&#39;,</span></span>
<span class="line"><span>  timeout: 30000 // 请求超时时间</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 请求拦截器</span></span>
<span class="line"><span>service.interceptors.request.use(</span></span>
<span class="line"><span>  config =&gt; {</span></span>
<span class="line"><span>    // config.headers[&#39;token&#39;] = &#39;&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    return config</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  error =&gt; {</span></span>
<span class="line"><span>    // 请求失败</span></span>
<span class="line"><span>   return Promise.reject(error)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 响应拦截器</span></span>
<span class="line"><span>service.interceptors.response.use(</span></span>
<span class="line"><span>  response =&gt; {</span></span>
<span class="line"><span>    const res = response.data || {}</span></span>
<span class="line"><span>    if (res.code !== 200) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return res</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  // 处理错误响应</span></span>
<span class="line"><span>  error =&gt; {</span></span>
<span class="line"><span>    if (error.response &amp;&amp; error.response.status === 401) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    } else if (error.response &amp;&amp; error.response.status === 403) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return Promise.reject(error)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default service</span></span></code></pre></div><p>api/home.ts:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import request from &#39;../utils/http.ts&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// {</span></span>
<span class="line"><span>//   data: {</span></span>
<span class="line"><span>//     channels: []</span></span>
<span class="line"><span>//   },</span></span>
<span class="line"><span>//   message: &#39;&#39;</span></span>
<span class="line"><span>// }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 1. 定义泛型</span></span>
<span class="line"><span>type ResType&lt;T&gt; = {</span></span>
<span class="line"><span>  message: string,</span></span>
<span class="line"><span>  data: T</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 2. 定义具体的接口类型</span></span>
<span class="line"><span>type ChannelItem = {</span></span>
<span class="line"><span>  id: number,</span></span>
<span class="line"><span>  name: string</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>type ChannelRes = {</span></span>
<span class="line"><span>  channels: ChannelItem[]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>export function fetchChannelAPI() {</span></span>
<span class="line"><span>  return request&lt;ResType&lt;ChannelRes&gt;&gt;({</span></span>
<span class="line"><span>    url: &#39;/home-data&#39;</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>优化，把公共 ResType 抽离出来</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>export type ResType&lt;T&gt; = {</span></span>
<span class="line"><span>  message: string,</span></span>
<span class="line"><span>  data: T</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 导入</span></span>
<span class="line"><span>import type { ResType } from &#39;./common.ts&#39;</span></span></code></pre></div><h2 id="父子组件交互" tabindex="-1">父子组件交互 <a class="header-anchor" href="#父子组件交互" aria-label="Permalink to &quot;父子组件交互&quot;">​</a></h2><p>子组件只能读取 props 中的数据，不能直接修改，父组件的数据只能由父组件修改。</p><p>父组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import Button from &#39;../components/button&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function Page1() {</span></span>
<span class="line"><span>  const buttonObj = {</span></span>
<span class="line"><span>    title: &#39;点击按钮&#39;,</span></span>
<span class="line"><span>    bgColor: &#39;red&#39;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  // 点击子组件按钮时触发</span></span>
<span class="line"><span>  function handleChildFn(msg) {</span></span>
<span class="line"><span>    console.log(&#39;父组件接收消息：&#39;, msg)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return &lt;div&gt;</span></span>
<span class="line"><span>    {/* &lt;Button title={buttonObj.title} bgColor={buttonObj.bgColor} /&gt; */}</span></span>
<span class="line"><span>    &lt;Button {...buttonObj} onMessageChange={handleChildFn} /&gt;</span></span>
<span class="line"><span>  &lt;/div&gt;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default Page1;</span></span></code></pre></div><p>子组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>function Button(props) {</span></span>
<span class="line"><span>  const buttonStyle = {</span></span>
<span class="line"><span>    padding: &#39;5px 10px&#39;,</span></span>
<span class="line"><span>    fontSize: &#39;16px&#39;,</span></span>
<span class="line"><span>    lineHeight: &#39;16px&#39;,</span></span>
<span class="line"><span>    border: &#39;1px solid #ccc&#39;,</span></span>
<span class="line"><span>    borderRadius: &#39;4px&#39;,</span></span>
<span class="line"><span>    cursor: &#39;pointer&#39;,</span></span>
<span class="line"><span>    marginTop: &#39;15px&#39;,</span></span>
<span class="line"><span>    backgroundColor: props.bgColor</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  function clickFn() {</span></span>
<span class="line"><span>    // 子传父</span></span>
<span class="line"><span>    props.onMessageChange(&#39;来自子组件&#39;)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return &lt;div style={buttonStyle} onClick={clickFn}&gt;</span></span>
<span class="line"><span>    &lt;span&gt;{props.title}&lt;/span&gt;</span></span>
<span class="line"><span>  &lt;/div&gt;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default Button;</span></span></code></pre></div><h4 id="特殊的-prop-children" tabindex="-1">特殊的 prop children <a class="header-anchor" href="#特殊的-prop-children" aria-label="Permalink to &quot;特殊的 prop children&quot;">​</a></h4><p>把内容嵌套在子组件标签中，父组件会自动把名为 children 的 prop 传递给子组件。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;Child&gt;</span></span>
<span class="line"><span>  &lt;span&gt;父&lt;/span&gt;</span></span>
<span class="line"><span>&lt;/Child&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function Child(props) {</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div&gt;</span></span>
<span class="line"><span>      child - {props.children}</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><img src="`+u+`" alt="alt text"></p><h2 id="react-hooks" tabindex="-1">React Hooks <a class="header-anchor" href="#react-hooks" aria-label="Permalink to &quot;React Hooks&quot;">​</a></h2><p>使函数式组件能够拥有类组件的一些特性，例如状态管理和生命周期方法的使用。</p><p>hooks 使用规则：</p><ol><li>必须使用 useXXX 格式命名</li><li>只能在 函数式组件内或其他hook 内调用</li><li>每次的调用顺序一致（不能放在for、if 内）</li></ol><h3 id="usestate" tabindex="-1">useState <a class="header-anchor" href="#usestate" aria-label="Permalink to &quot;useState&quot;">​</a></h3><p>向组件添加状态变量</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const [count, setCount] = useState(0);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// setCount(count + 1) // 这种写法多次执行count只累加一次（合并更新）</span></span>
<span class="line"><span>// 或</span></span>
<span class="line"><span>setCount((count) =&gt; count + 1) // 如果页面中 count 是 6</span></span>
<span class="line"><span>console.log(count) // 那这里是 5，异步更新无法直接拿到最新的 state 值</span></span>
<span class="line"><span>// 如果 state 不用于 JSX 中显示，那就不要用 useState，用 useRef</span></span>
<span class="line"><span>// 可以使用 useEffect 把 count 作为依赖进行监听，实时获取最新 count</span></span></code></pre></div><p>state 是不可变数据 (不能 count++，视图不更新)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 修改对象</span></span>
<span class="line"><span>setUserInfo({</span></span>
<span class="line"><span>  ...userInfo,</span></span>
<span class="line"><span>  age: 21</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span>setUserInfo({</span></span>
<span class="line"><span>  x: 100</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span>// 修改数组</span></span>
<span class="line"><span>setList(list.concat(&#39;z&#39;))</span></span>
<span class="line"><span>setList([...list, &#39;z&#39;]) </span></span>
<span class="line"><span>// filter</span></span></code></pre></div><blockquote><p>可以使用 <strong>immer</strong> 修改 state 不可变数据</p></blockquote><h3 id="useeffect" tabindex="-1">useEffect <a class="header-anchor" href="#useeffect" aria-label="Permalink to &quot;useEffect&quot;">​</a></h3><p>在组件渲染到屏幕之后异步执行(dom可用)。这意味着它不会阻塞浏览器的绘制和更新，适用于大多数不会直接影响页面布局和视觉呈现的操作，用于执行副作用操作，如本地存储、ajax、操作DOM、计时器等‌。</p><p>副作用函数：指的是那些在执行时会改变外部状态或依赖外部可变状态的函数。</p>`,55),y=l(`<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>useEffect(() =&gt; {</span></span>
<span class="line"><span>  const connection = createConnection(serverUrl, roomId);</span></span>
<span class="line"><span>  connection.connect();</span></span>
<span class="line"><span>  return () =&gt; {</span></span>
<span class="line"><span>    // 清除函数</span></span>
<span class="line"><span>    connection.disconnect();</span></span>
<span class="line"><span>  };</span></span>
<span class="line"><span>}, [serverUrl, roomId]);</span></span></code></pre></div><ul><li>‌不传第二个参数‌：监测所有状态和属性，任何变化都会触发副作用函数：组件初始渲染+组件更新时执行</li><li>‌第二个参数为空数组‌（[]）：表示不监测任何依赖项，组件挂载时执行副作用函数，卸载时执行清除函数。</li><li>‌第二个参数为具体依赖项数组‌：组件初始渲染会执行；数组中的任意一个依赖项发生变化时，副作用函数也会执行，执行新的副作用之前会调用清除函数。</li></ul><h3 id="uselayouteffect‌" tabindex="-1">useLayoutEffect‌ <a class="header-anchor" href="#uselayouteffect‌" aria-label="Permalink to &quot;useLayoutEffect‌&quot;">​</a></h3><ul><li>在DOM更新完成后、浏览器绘制前‌同步执行‌，会阻塞浏览器的重绘过程</li><li>典型应用场景：动态调整元素尺寸/位置、避免UI闪烁等需要即时获取布局信息的操作</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import React, { useEffect, useLayoutEffect, useRef } from &#39;react&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function Detail() {</span></span>
<span class="line"><span>  const onScrollFn = (e: React.UIEvent&lt;HTMLDivElement&gt;) =&gt; {</span></span>
<span class="line"><span>    const scrollTop = e.currentTarget.scrollTop</span></span>
<span class="line"><span>    window.history.replaceState(null, &#39;&#39;, \`?top=\${scrollTop}\`)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const container = useRef&lt;HTMLDivElement&gt;(null)</span></span>
<span class="line"><span>  useLayoutEffect(() =&gt; {</span></span>
<span class="line"><span>    const top = window.location.search.split(&#39;=&#39;)[1]</span></span>
<span class="line"><span>    if (top &amp;&amp; container.current) {</span></span>
<span class="line"><span>      container.current.scrollTo(0, Number(top))</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }, [])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div onScroll={onScrollFn} ref={container} style={{ height: &#39;400px&#39;, overflowY: &#39;auto&#39; }}&gt;</span></span>
<span class="line"><span>      &lt;div&gt;Detail&lt;/div&gt;</span></span>
<span class="line"><span>      {</span></span>
<span class="line"><span>        new Array(3000).fill(0).map((item, index) =&gt; {</span></span>
<span class="line"><span>          return &lt;div key={index}&gt;{index}&lt;/div&gt;</span></span>
<span class="line"><span>        })</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default Detail</span></span></code></pre></div><p>浏览器打开 url?top=10000会直接跳到该位置；如果用useEffect，会先在页面顶部，然后闪一下跳到10000位置。</p><h3 id="useref" tabindex="-1">useRef <a class="header-anchor" href="#useref" aria-label="Permalink to &quot;useRef&quot;">​</a></h3><p>访问 DOM 元素或保存不触发渲染的变量(不能作为hooks的依赖项，因为它不是一个响应式状态)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const divRef = useRef(null);</span></span>
<span class="line"><span>let count = useRef(0);</span></span>
<span class="line"><span>useEffect(() =&gt; {</span></span>
<span class="line"><span>  console.log(&#39;divRef.current: &#39;, divRef.current)</span></span>
<span class="line"><span>}, [])</span></span>
<span class="line"><span>function clickFn() {</span></span>
<span class="line"><span>  count.current = count.current + 1;</span></span>
<span class="line"><span>  console.log(&#39;count:&#39;, count.current)</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return &lt;div ref={divRef} onClick={clickFn}&lt;/div&gt;</span></span></code></pre></div><h3 id="usecontext" tabindex="-1">useContext <a class="header-anchor" href="#usecontext" aria-label="Permalink to &quot;useContext&quot;">​</a></h3><p>跨层级组件通信。</p><p>ThemeContext.js</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { createContext } from &#39;react&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 默认值 &#39;light&#39;</span></span>
<span class="line"><span>export const ThemeContext = createContext(&#39;light&#39;)</span></span></code></pre></div><p>在顶层用 Provider 提供状态:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useState } from &#39;react&#39;</span></span>
<span class="line"><span>import { ThemeContext } from &#39;./ThemeContext&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function App() {</span></span>
<span class="line"><span>const [theme, setTheme] = useState(&#39;light&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return (</span></span>
<span class="line"><span>    &lt;ThemeContext.Provider value={theme}&gt;</span></span>
<span class="line"><span>      ...</span></span>
<span class="line"><span>      &lt;button onClick={() =&gt; setTheme(theme === &#39;light&#39; ? &#39;dark&#39; : &#39;light&#39;)}&gt;</span></span>
<span class="line"><span>        切换主题</span></span>
<span class="line"><span>      &lt;/button&gt;</span></span>
<span class="line"><span>    &lt;/ThemeContext.Provider&gt;</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default App</span></span></code></pre></div><p>在ThemeContext.Provider内的子组件中都可以使用 useContext 获取状态：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useContext } from &#39;react&#39;</span></span>
<span class="line"><span>import { ThemeContext } from &#39;../ThemeContext&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const Child = () =&gt; {</span></span>
<span class="line"><span>  const theme = useContext(ThemeContext)</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div&gt;</span></span>
<span class="line"><span>      当前主题: {theme}</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>};</span></span></code></pre></div><h3 id="usereducer" tabindex="-1">useReducer <a class="header-anchor" href="#usereducer" aria-label="Permalink to &quot;useReducer&quot;">​</a></h3><p>useState 的替代方案，适用于管理复杂和大型的状态逻辑。</p><ul><li>定义 Reducer 函数（根据不同action返回不同的新状态）</li><li>在组件中调用 useReducer，传入 reducer 函数和初始状态值</li><li>dispatch 分派一个 action 对象</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useReducer } from &quot;react&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function Counter() {</span></span>
<span class="line"><span>  function reducer(state, action) {</span></span>
<span class="line"><span>    switch (action.type) {</span></span>
<span class="line"><span>      case &#39;increment&#39;:</span></span>
<span class="line"><span>        return {count: state.count + 1}</span></span>
<span class="line"><span>      case &#39;decrement&#39;:</span></span>
<span class="line"><span>        return {count: state.count - 1}</span></span>
<span class="line"><span>      case &#39;set&#39;:</span></span>
<span class="line"><span>        return {count: action.payload1}</span></span>
<span class="line"><span>      default:</span></span>
<span class="line"><span>        return {count: state.count}</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const [state, dispatch] = useReducer(reducer, {count: 0})</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;&gt;</span></span>
<span class="line"><span>      &lt;p&gt;您点击了 {state.count} 次&lt;/p&gt;</span></span>
<span class="line"><span>      &lt;Button variant=&quot;outlined&quot; onClick={() =&gt; dispatch({type: &#39;decrement&#39;})}&gt;递减&lt;/Button&gt;</span></span>
<span class="line"><span>      &lt;Button variant=&quot;outlined&quot; onClick={() =&gt; dispatch({type: &#39;increment&#39;})} style={{marginLeft: 15}}&gt;递增&lt;/Button&gt;</span></span>
<span class="line"><span>      &lt;Button variant=&quot;outlined&quot; onClick={() =&gt; dispatch({type: &#39;set&#39;, payload1: 100})} style={{marginLeft: 15}}&gt;设为100&lt;/Button&gt;</span></span>
<span class="line"><span>    &lt;/&gt;</span></span>
<span class="line"><span>  )}</span></span></code></pre></div><h3 id="usememo" tabindex="-1">useMemo <a class="header-anchor" href="#usememo" aria-label="Permalink to &quot;useMemo&quot;">​</a></h3><p>在组件每次重新渲染的时候缓存计算的结果。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  function fib(n) {</span></span>
<span class="line"><span>    console.log(&#39;执行&#39;)</span></span>
<span class="line"><span>    if (n &lt; 3) {</span></span>
<span class="line"><span>      return 1</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return fib(n - 1) + fib(n - 2)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  let [count1, setCount1] = useState(0)</span></span>
<span class="line"><span>  let [count2, setCount2] = useState(0)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 这种写法，count1、count2 改变时，组件重新渲染，fib执行</span></span>
<span class="line"><span>  // const result = fib(count1)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const result = useMemo(() =&gt; {</span></span>
<span class="line"><span>    // 监听count1改变时才会执行 fib</span></span>
<span class="line"><span>    return fib(count1)</span></span>
<span class="line"><span>  }, [count1])</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;div&gt;</span></span>
<span class="line"><span>        &lt;div&gt;{result}&lt;/div&gt;</span></span>
<span class="line"><span>        &lt;button onClick={() =&gt; setCount1(count1+1)}&gt;{count1}&lt;/button&gt;</span></span>
<span class="line"><span>        &lt;button onClick={() =&gt; setCount2(count2+1)}&gt;{count2}&lt;/button&gt;</span></span>
<span class="line"><span>    &lt;/div&gt;</span></span>
<span class="line"><span>  )</span></span></code></pre></div><h4 id="react-memo-高阶组件" tabindex="-1">React.memo 高阶组件 <a class="header-anchor" href="#react-memo-高阶组件" aria-label="Permalink to &quot;React.memo 高阶组件&quot;">​</a></h4><p>React组件默认的渲染机制：只要父组件重新渲染子组件就会重新渲染。</p><p>memo 作用：允许组件在props没有改变的情况下跳过渲染。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { memo } from &quot;react&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function Child(props) {</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>export default memo(Child)</span></span></code></pre></div><p>父组件</p><ol><li>基本类型：count改变，子组件就重新渲染:</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;Child count={count}/&gt;</span></span></code></pre></div><ol start="2"><li>引用类型：list定义在父组件内，父组件状态更新list会被重新定义，子组件就会重新渲染。</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>function Parent() {</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const list = [1,2,3]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  &lt;Child list={list}/&gt;</span></span>
<span class="line"><span>}</span></span></code></pre></div><ol start="3"><li>使用useMemo缓存，即使父组件状态更新，但是list不变，子组件也不会重新渲染。</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>function Parent() {</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const list = useMemo(() =&gt; {</span></span>
<span class="line"><span>    return [1,2,3]</span></span>
<span class="line"><span>  }, [])</span></span>
<span class="line"><span>  // or</span></span>
<span class="line"><span>  const [list] = useState([1, 2, 3, 4, 5])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  &lt;Child list={list}/&gt;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 子组件必须进行memo优化，否则useMemo没有任何性能提升。</span></span></code></pre></div><h3 id="usecallback" tabindex="-1">useCallback <a class="header-anchor" href="#usecallback" aria-label="Permalink to &quot;useCallback&quot;">​</a></h3><p>作用：在组件多次重新渲染的时候缓存函数。</p><p>之前：</p><p>父组件状态更新，onChange属性值handleChange会重新创建，导致子组件重新渲染。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useCallback } from &quot;react&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const handleChange = (value) =&gt; {</span></span>
<span class="line"><span>  console.log(&#39;value--&#39;, value)</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;Child onChange={handleChange} /&gt;</span></span></code></pre></div><p>之后：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useCallback } from &quot;react&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const handleChange = useCallback((value) =&gt; {</span></span>
<span class="line"><span>  console.log(&#39;value--&#39;, value)</span></span>
<span class="line"><span>}, [])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;Child onChange={handleChange} /&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 子组件必须进行memo优化，否则useCallback没有任何性能提升。</span></span></code></pre></div><h4 id="forwardref-高阶组件" tabindex="-1">forwardRef 高阶组件 <a class="header-anchor" href="#forwardref-高阶组件" aria-label="Permalink to &quot;forwardRef 高阶组件&quot;">​</a></h4><p>父组件通过ref属性获取子组件实例，并调用子组件实例的方法。</p><p>子组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { forwardRef } from &#39;react&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const Input = forwardRef((props, ref) =&gt; {</span></span>
<span class="line"><span>  return &lt;input type=&quot;text&quot; ref={ref} /&gt;</span></span>
<span class="line"><span>})</span></span></code></pre></div><p>父组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>function App() {</span></span>
<span class="line"><span>  const inputRef = useRef(null)</span></span>
<span class="line"><span>  function showRef() {</span></span>
<span class="line"><span>    inputRef.current &amp;&amp; inputRef.current.focus() // 子组件聚焦</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;&gt;</span></span>
<span class="line"><span>      &lt;Input ref={inputRef} /&gt;</span></span>
<span class="line"><span>      &lt;button onClick={showRef}&gt;click&lt;/button&gt;</span></span>
<span class="line"><span>    &lt;/&gt;</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="useimperativehandle" tabindex="-1">useImperativeHandle <a class="header-anchor" href="#useimperativehandle" aria-label="Permalink to &quot;useImperativeHandle&quot;">​</a></h3><p>用于暴露子组件的属性和方法，实现父组件对子组件的控制。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>useImperativeHandle(ref, () =&gt; {</span></span>
<span class="line"><span>  return {</span></span>
<span class="line"><span>    </span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}, [deps])</span></span></code></pre></div><ul><li>不传入依赖deps参数，useImperativeHandle会在组件挂载时执行一次，状态更新时也会执行</li><li>deps 传 []，useImperativeHandle会在组件挂载时执行一次，状态更新时不会执行</li><li>deps 传依赖项，useImperativeHandle会在组件挂载时执行一次，依赖项变化时也会执行</li></ul><p>子组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { forwardRef, useRef, useImperativeHandle } from &#39;react&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 需要结合 forwardRef 使用</span></span>
<span class="line"><span>const MyInput = forwardRef((props:any, ref:any) =&gt; {</span></span>
<span class="line"><span>  const inputRef = useRef&lt;HTMLInputElement&gt;(null);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  useImperativeHandle(ref, () =&gt; ({</span></span>
<span class="line"><span>    focus: () =&gt; {</span></span>
<span class="line"><span>      inputRef.current?.focus()</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    testValue: 123</span></span>
<span class="line"><span>  }));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return (&lt;input {...props} ref={inputRef} /&gt;)</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>export default MyInput;</span></span></code></pre></div><p>父组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const compRef = useRef&lt;any&gt;(null);</span></span>
<span class="line"><span>function buttonClick() {</span></span>
<span class="line"><span>  if (compRef.current !== null) {</span></span>
<span class="line"><span>    compRef.current.focus();</span></span>
<span class="line"><span>    console.log(compRef.current.testValue)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>&lt;form&gt;</span></span>
<span class="line"><span>  &lt;MyInput placeholder=&#39;please input&#39; ref={compRef} /&gt;</span></span>
<span class="line"><span>  &lt;button type=&quot;button&quot; onClick={buttonClick}&gt; Edit &lt;/button&gt;</span></span>
<span class="line"><span>&lt;/form&gt;</span></span></code></pre></div><h3 id="usesyncexternalstore" tabindex="-1">useSyncExternalStore <a class="header-anchor" href="#usesyncexternalstore" aria-label="Permalink to &quot;useSyncExternalStore&quot;">​</a></h3><p>用于从外部存储(例如状态管理库、浏览器API等)获取状态并在数据更新时触发组件更新。</p><p>用法：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const res = useSyncExternalStore(subscribe, getSnapshot, getServerSnapShot?)</span></span></code></pre></div><ul><li>subscribe: 订阅数据源的变化，接收一个回调函数，在数据源更新时调用该回调函数</li><li>getSnapshot: 获取数据源的快照（当前状态）</li><li>getServerSnapShot?: 在服务端渲染时用来获取数据源的快照（可选）</li></ul><p>useStorage.ts:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useSyncExternalStore } from &quot;react&quot;;</span></span>
<span class="line"><span>export function useStorage(key: string, initValue: any) {</span></span>
<span class="line"><span>  const subscribe = (callback: () =&gt; void) =&gt; {</span></span>
<span class="line"><span>    // 订阅</span></span>
<span class="line"><span>    window.addEventListener(&quot;storage&quot;, callback);</span></span>
<span class="line"><span>    return () =&gt; {</span></span>
<span class="line"><span>      // 取消订阅</span></span>
<span class="line"><span>      window.removeEventListener(&quot;storage&quot;, callback);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  const getSnapshot = () =&gt; {</span></span>
<span class="line"><span>    const data = window.localStorage.getItem(key);</span></span>
<span class="line"><span>    return data ? JSON.parse(data) : initValue;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 不用 useState 也能达到数据更新</span></span>
<span class="line"><span>  const res = useSyncExternalStore(subscribe, getSnapshot)</span></span>
<span class="line"><span>  const updateStorage = (value: any) =&gt; {</span></span>
<span class="line"><span>    window.localStorage.setItem(key, JSON.stringify(value));</span></span>
<span class="line"><span>    // 通知订阅者</span></span>
<span class="line"><span>    window.dispatchEvent(new StorageEvent(&quot;storage&quot;));</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return [res, updateStorage]</span></span>
<span class="line"><span>}</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const [count, setCount] = useStorage(&#39;count&#39;, 0)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span>  &lt;Button type=&quot;primary&quot; onClick={() =&gt; setCount(count - 1)}&gt;-&lt;/Button&gt;</span></span>
<span class="line"><span>  &lt;div&gt;{ count }&lt;/div&gt;</span></span>
<span class="line"><span>  &lt;Button type=&quot;primary&quot; onClick={() =&gt; setCount(count + 1)}&gt;+&lt;/Button&gt;</span></span>
<span class="line"><span>&lt;/div&gt;</span></span></code></pre></div><p><img src="`+h+`" alt="alt text"></p><h3 id="usetransition" tabindex="-1">useTransition <a class="header-anchor" href="#usetransition" aria-label="Permalink to &quot;useTransition&quot;">​</a></h3><p>useTransition 不阻塞 UI 的情况下更新状态。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const [isPending, startTransition] = useTransition()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 紧急更新: 实时显示输入的内容不卡顿</span></span>
<span class="line"><span>setInputValue(input);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>startTransition(() =&gt; {</span></span>
<span class="line"><span>  // 过渡更新: 展示结果列表，低优先级</span></span>
<span class="line"><span>  setResultList(input);</span></span>
<span class="line"><span>});</span></span></code></pre></div><p><img src="`+g+'" alt="alt text"><img src="'+m+`" alt="alt text"></p><h3 id="usedeferredvalue" tabindex="-1">useDeferredValue <a class="header-anchor" href="#usedeferredvalue" aria-label="Permalink to &quot;useDeferredValue&quot;">​</a></h3><p>延迟更新 UI 的某些部分。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const [inputValue, setInputValue] = useState(&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const deferredValue = useDeferredValue(inputValue)</span></span>
<span class="line"><span>console.log(&#39;deferredValue:&#39;+deferredValue+&#39; ,inputValue:&#39;+ inputValue)</span></span>
<span class="line"><span>// deferredValue === inputValue 执行某些操作</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;Input value={inputValue} onChange={(e) =&gt; setInputValue(e.target.value)} /&gt;</span></span></code></pre></div><p>deferredValue 是延迟更新的值。和防抖的区别是：防抖是固定一个时间值，useDeferredValue返回的延迟值取决于设备的性能。</p><p><img src="`+b+`" alt="alt text"></p><h3 id="自定义-hooks" tabindex="-1">自定义 hooks <a class="header-anchor" href="#自定义-hooks" aria-label="Permalink to &quot;自定义 hooks&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { useState, useEffect, useCallback } from &#39;react&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 获取鼠标位置</span></span>
<span class="line"><span>export function useMouse() {</span></span>
<span class="line"><span>  const [x, setX] = useState(0)</span></span>
<span class="line"><span>  const [y, setY] = useState(0)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const updateMouse = useCallback((e: MouseEvent) =&gt; {</span></span>
<span class="line"><span>    setX(e.clientX)</span></span>
<span class="line"><span>    setY(e.clientY)</span></span>
<span class="line"><span>  }, [])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  useEffect(() =&gt; {</span></span>
<span class="line"><span>    window.addEventListener(&#39;mousemove&#39;, updateMouse)</span></span>
<span class="line"><span>    return () =&gt; {</span></span>
<span class="line"><span>      window.removeEventListener(&#39;mousemove&#39;, updateMouse)</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }, [])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return { x, y }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 模拟异步数据</span></span>
<span class="line"><span>function getInfo(): Promise&lt;string&gt; {</span></span>
<span class="line"><span>  return new Promise((resolve) =&gt; {</span></span>
<span class="line"><span>    setTimeout(() =&gt; {</span></span>
<span class="line"><span>      resolve(Date.now().toString())</span></span>
<span class="line"><span>    }, 1500)</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>export function useGetInfo() {</span></span>
<span class="line"><span>  const [loading, setLoading] = useState(true)</span></span>
<span class="line"><span>  const [info, setInfo] = useState(&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  useEffect(() =&gt; {</span></span>
<span class="line"><span>    getInfo().then((res) =&gt; {</span></span>
<span class="line"><span>      setLoading(false)</span></span>
<span class="line"><span>      setInfo(res)</span></span>
<span class="line"><span>    })</span></span>
<span class="line"><span>  }, [])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return {</span></span>
<span class="line"><span>    loading,</span></span>
<span class="line"><span>    info</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 引用</span></span>
<span class="line"><span>import { useMouse, useGetInfo } from &#39;./hook&#39;</span></span>
<span class="line"><span>const { x, y } = useMouse()</span></span>
<span class="line"><span>const { loading, info } = useGetInfo()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span>  &lt;div&gt;鼠标位置：{x},{y}&lt;/div&gt;</span></span>
<span class="line"><span>  &lt;div&gt;{loading ? &#39;加载中&#39; : info}&lt;/div&gt;</span></span>
<span class="line"><span>&lt;/div&gt;</span></span></code></pre></div><h3 id="第三方-hooks" tabindex="-1">第三方 hooks <a class="header-anchor" href="#第三方-hooks" aria-label="Permalink to &quot;第三方 hooks&quot;">​</a></h3><p><a href="https://ahooks.js.org/zh-CN" target="_blank" rel="noreferrer">https://ahooks.js.org/zh-CN</a></p><p><a href="https://github.com/streamich/react-use" target="_blank" rel="noreferrer">https://github.com/streamich/react-use</a></p><h2 id="ant-design" tabindex="-1">Ant Design <a class="header-anchor" href="#ant-design" aria-label="Permalink to &quot;Ant Design&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm install antd</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import { Button } from &#39;antd&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;Button type=&quot;primary&quot;&gt;Primary Button&lt;/Button&gt;</span></span></code></pre></div><h3 id="antd-mobile-主题定制" tabindex="-1">antd-mobile 主题定制 <a class="header-anchor" href="#antd-mobile-主题定制" aria-label="Permalink to &quot;antd-mobile 主题定制&quot;">​</a></h3><p><a href="https://mobile.ant.design/zh/guide/theming" target="_blank" rel="noreferrer">https://mobile.ant.design/zh/guide/theming</a></p><h4 id="全局定制" tabindex="-1">全局定制 <a class="header-anchor" href="#全局定制" aria-label="Permalink to &quot;全局定制&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>:root:root {</span></span>
<span class="line"><span>  --adm-color-primary: red;</span></span>
<span class="line"><span>}</span></span></code></pre></div><h4 id="局部定制" tabindex="-1">局部定制 <a class="header-anchor" href="#局部定制" aria-label="Permalink to &quot;局部定制&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>.puple {</span></span>
<span class="line"><span>  --adm-color-primary: red;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div className=&quot;puple&quot;&gt;</span></span>
<span class="line"><span>  &lt;Button color=&quot;primary&quot;&gt;btn&lt;/Button&gt;</span></span>
<span class="line"><span>&lt;/div&gt;</span></span></code></pre></div><h2 id="配置多环境" tabindex="-1">配置多环境 <a class="header-anchor" href="#配置多环境" aria-label="Permalink to &quot;配置多环境&quot;">​</a></h2><p>Create React App 搭建的项目，npm run start 指向 development，npm run build 指向 production，通过 process.env.NODE_ENV 获取。</p><h4 id="第一种方式-使用-cross-env" tabindex="-1">第一种方式：使用 cross-env <a class="header-anchor" href="#第一种方式-使用-cross-env" aria-label="Permalink to &quot;第一种方式：使用 cross-env&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 安装 cross-env</span></span>
<span class="line"><span>npm i cross-env -D</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 配置不同环境命令，REACT_APP_开头</span></span>
<span class="line"><span>&quot;build:release&quot;: &quot;cross-env REACT_APP_ENV=release react-scripts build&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 获取</span></span>
<span class="line"><span>process.env.REACT_APP_ENV // release</span></span></code></pre></div><h4 id="第二种方式-使用-dotenv" tabindex="-1">第二种方式：使用 dotenv <a class="header-anchor" href="#第二种方式-使用-dotenv" aria-label="Permalink to &quot;第二种方式：使用 dotenv&quot;">​</a></h4><p>安装</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm install dotenv-cli -D</span></span></code></pre></div><p>自定义环境变量名</p><p><img src="`+v+`" alt="alt text"></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 配置</span></span>
<span class="line"><span>&quot;start&quot;: &quot;dotenv -e .env.release react-scripts start&quot;,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 获取</span></span>
<span class="line"><span>process.env.REACT_APP_ENV // release</span></span></code></pre></div><h2 id="项目打包和本地预览" tabindex="-1">项目打包和本地预览 <a class="header-anchor" href="#项目打包和本地预览" aria-label="Permalink to &quot;项目打包和本地预览&quot;">​</a></h2><p>先打包:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm run build</span></span></code></pre></div><p>安装 serve:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i serve -g</span></span></code></pre></div><p>启动本地服务：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>serve -s build</span></span></code></pre></div><h4 id="包体积可视化分析" tabindex="-1">包体积可视化分析 <a class="header-anchor" href="#包体积可视化分析" aria-label="Permalink to &quot;包体积可视化分析&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npm i source-map-explorer</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&quot;scripts&quot;: {</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    &quot;analyze&quot;: &quot;source-map-explorer build/**/*.{js,css}&quot;</span></span>
<span class="line"><span>},</span></span>
<span class="line"><span></span></span>
<span class="line"><span>npm run analyze</span></span></code></pre></div><h4 id="cdn" tabindex="-1">CDN <a class="header-anchor" href="#cdn" aria-label="Permalink to &quot;CDN&quot;">​</a></h4><p>craco.config.js:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const { whenProd, pluginByName, getPlugin } = require(&#39;@craco/craco&#39;);</span></span>
<span class="line"><span>const path = require(&#39;path&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>module.exports = {</span></span>
<span class="line"><span>  webpack: {</span></span>
<span class="line"><span>    alias: {</span></span>
<span class="line"><span>      &#39;@&#39;: path.resolve(__dirname, &#39;src&#39;),</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    configure: (webpackConfig, { env, paths }) =&gt; {</span></span>
<span class="line"><span>      let cdn;</span></span>
<span class="line"><span>      whenProd(() =&gt; {</span></span>
<span class="line"><span>        // key: npm 安装的包； value: CDN里的全局变量</span></span>
<span class="line"><span>        // 打包时排除 react 和 react-dom</span></span>
<span class="line"><span>        webpackConfig.externals = {</span></span>
<span class="line"><span>          react: &#39;React&#39;,</span></span>
<span class="line"><span>          &#39;react-dom&#39;: &#39;ReactDOM&#39;,</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        cdn = {</span></span>
<span class="line"><span>          js: [</span></span>
<span class="line"><span>            &#39;https://cdnjs.cloudflare.com/ajax/libs/react/18.1.0/umd/react.production.min.js&#39;,</span></span>
<span class="line"><span>            &#39;https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.1.0/umd/react-dom.production.min.js&#39;</span></span>
<span class="line"><span>          ]</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      })</span></span>
<span class="line"><span>      </span></span>
<span class="line"><span>      // 通过 HtmlWebpackPlugin 在public/index.html注入cdn</span></span>
<span class="line"><span>      const { isFound, match } = getPlugin(webpackConfig, pluginByName(&#39;HtmlWebpackPlugin&#39;));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      // 找到了HtmlWebpackPlugin插件</span></span>
<span class="line"><span>      if (isFound) {</span></span>
<span class="line"><span>        match.options.cdn = cdn;</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      return webpackConfig;</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>};</span></span></code></pre></div><p>配置引入CDN地址，public/index.html:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span>&lt;% htmlWebpackPlugin.options.cdn.js.forEach(cdnURL =&gt; { %&gt;</span></span>
<span class="line"><span>  &lt;script src=&quot;&lt;%= cdnURL %&gt;&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;% }) %&gt;</span></span></code></pre></div><h2 id="typescript" tabindex="-1">TypeScript <a class="header-anchor" href="#typescript" aria-label="Permalink to &quot;TypeScript&quot;">​</a></h2><p>tsconfig.json:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;compilerOptions&quot;: {</span></span>
<span class="line"><span>    &quot;target&quot;: &quot;es5&quot;,</span></span>
<span class="line"><span>    &quot;lib&quot;: [</span></span>
<span class="line"><span>      &quot;dom&quot;,</span></span>
<span class="line"><span>      &quot;dom.iterable&quot;,</span></span>
<span class="line"><span>      &quot;esnext&quot;</span></span>
<span class="line"><span>    ],</span></span>
<span class="line"><span>    &quot;allowJs&quot;: true,</span></span>
<span class="line"><span>    &quot;skipLibCheck&quot;: true,</span></span>
<span class="line"><span>    &quot;esModuleInterop&quot;: true,</span></span>
<span class="line"><span>    &quot;allowSyntheticDefaultImports&quot;: true,</span></span>
<span class="line"><span>    &quot;strict&quot;: true,</span></span>
<span class="line"><span>    &quot;forceConsistentCasingInFileNames&quot;: true,</span></span>
<span class="line"><span>    &quot;noFallthroughCasesInSwitch&quot;: true,</span></span>
<span class="line"><span>    &quot;module&quot;: &quot;esnext&quot;,</span></span>
<span class="line"><span>    &quot;moduleResolution&quot;: &quot;node&quot;,</span></span>
<span class="line"><span>    &quot;resolveJsonModule&quot;: true,</span></span>
<span class="line"><span>    &quot;isolatedModules&quot;: true,</span></span>
<span class="line"><span>    &quot;noEmit&quot;: true,</span></span>
<span class="line"><span>    &quot;jsx&quot;: &quot;react-jsx&quot;</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  &quot;include&quot;: [</span></span>
<span class="line"><span>    &quot;src&quot;</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>声明文件 react-app-env.d.ts：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>declare module &#39;*.svg&#39; {</span></span>
<span class="line"><span>  import * as React from &#39;react&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  export const ReactComponent: React.FunctionComponent&lt;React.SVGProps&lt;</span></span>
<span class="line"><span>    SVGSVGElement</span></span>
<span class="line"><span>  &gt; &amp; { title?: string }&gt;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  const src: string;</span></span>
<span class="line"><span>  export default src;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>declare module &#39;*.module.scss&#39; {</span></span>
<span class="line"><span>  const classes: { readonly [key: string]: string };</span></span>
<span class="line"><span>  export default classes;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>将文件重命名为 .tsx 或 .ts 文件。</p><h3 id="props与ts" tabindex="-1">Props与TS <a class="header-anchor" href="#props与ts" aria-label="Permalink to &quot;Props与TS&quot;">​</a></h3><p>子组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>type Props = {</span></span>
<span class="line"><span>  className: string,</span></span>
<span class="line"><span>  title?: string,</span></span>
<span class="line"><span>  children?: React.ReactNode,</span></span>
<span class="line"><span>  onGetMsg?: (msg: string) =&gt; void</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>function Button(props: Props) {</span></span>
<span class="line"><span>  const {className, children, onGetMsg} = props</span></span>
<span class="line"><span>  function clickHandler() {</span></span>
<span class="line"><span>    onGetMsg?.(&#39;this is msg from son button&#39;)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    &lt;button className={className} onClick={clickHandler}&gt;</span></span>
<span class="line"><span>      { children}</span></span>
<span class="line"><span>    &lt;/button&gt;</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>父组件：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>function receiveMsg(msg: string) {</span></span>
<span class="line"><span>  console.log(&#39;msg--&#39;, msg)</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>&lt;Button className=&#39;btn&#39; onGetMsg={receiveMsg}&gt;</span></span>
<span class="line"><span>  click me!</span></span>
<span class="line"><span>&lt;/Button&gt;</span></span>
<span class="line"><span>&lt;Button className=&#39;btn&#39; onGetMsg={(msg) =&gt; console.log(msg)}&gt;</span></span>
<span class="line"><span>  内联方法msg自动推断类型</span></span>
<span class="line"><span>&lt;/Button&gt;</span></span></code></pre></div><h3 id="useref与ts" tabindex="-1">useRef与TS <a class="header-anchor" href="#useref与ts" aria-label="Permalink to &quot;useRef与TS&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const inputRef = useRef&lt;HTMLInputElement&gt;(null)</span></span>
<span class="line"><span>useEffect(() =&gt; {</span></span>
<span class="line"><span>  inputRef.current?.focus()</span></span>
<span class="line"><span>}, [])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;input ref={inputRef} /&gt;</span></span></code></pre></div><p>联合类型：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const timerRef = useRef&lt;number | undefined&gt;(undefined)</span></span>
<span class="line"><span>useEffect(() =&gt; {</span></span>
<span class="line"><span>  timerRef.current = setInterval(() =&gt; {</span></span>
<span class="line"><span>    console.log(&#39;tick&#39;)</span></span>
<span class="line"><span>  }, 1000)</span></span>
<span class="line"><span>  return () =&gt; {</span></span>
<span class="line"><span>    clearInterval(timerRef.current)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}, [])</span></span></code></pre></div>`,126);function C(q,P,A,R,w,B){const n=i("font");return o(),c("div",null,[k,a("ul",null,[a("li",null,[s("定义一个 "),p(n,{color:"red"},{default:e(()=>[s("reducer 函数")]),_:1})]),a("li",null,[s("使用 "),p(n,{color:"red"},{default:e(()=>[s("createStore")]),_:1}),s(" 方法传入 reducer 函数 生成一个 store 实例对象")]),a("li",null,[s("使用 store 实例的 "),p(n,{color:"red"},{default:e(()=>[s("subscribe 方法")]),_:1}),s(" 订阅数据的变化")]),a("li",null,[s("使用 store 实例的 "),p(n,{color:"red"},{default:e(()=>[s("dispatch方法提交action对象")]),_:1}),s(" 触发数据变化")]),a("li",null,[s("使用 store 实例的 "),p(n,{color:"red"},{default:e(()=>[s("getState方法")]),_:1}),s(" 获取最新的状态数据更新到视图中")])]),x,p(n,{size:"2.5"},{default:e(()=>[s("注：react18 开始，useEffect 在开发环境下会执行两次(<React.StrictMode>)，模拟组件创建、销毁、再创建的完整流程，及早暴露问题；生产环境下只执行一次。")]),_:1}),y])}const M=t(f,[["render",C]]);export{E as __pageData,M as default};
