import{_ as a,c as n,o as s,a3 as e}from"./chunks/framework.C5U8cnJv.js";const m=JSON.parse('{"title":"统一前端项目的Node版本和包管理器","description":"","frontmatter":{},"headers":[],"relativePath":"nodejs/项目统一node版本.md","filePath":"nodejs/项目统一node版本.md"}'),p={name:"nodejs/项目统一node版本.md"},t=e(`<h1 id="统一前端项目的node版本和包管理器" tabindex="-1">统一前端项目的Node版本和包管理器 <a class="header-anchor" href="#统一前端项目的node版本和包管理器" aria-label="Permalink to &quot;统一前端项目的Node版本和包管理器&quot;">​</a></h1><h2 id="锁定项目-node-版本" tabindex="-1">锁定项目 Node 版本 <a class="header-anchor" href="#锁定项目-node-版本" aria-label="Permalink to &quot;锁定项目 Node 版本&quot;">​</a></h2><p>通过在 package.json 中指定 engines 字段，可限定项目使用的 node 版本。下面配置仅允许用户使用 14 或者 16的版本。更多的配置可以参考</p><p><a href="https://www.npmjs.cn/files/package.json/" target="_blank" rel="noreferrer">https://www.npmjs.cn/files/package.json/</a></p><p>package.json</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&quot;engines&quot;: {</span></span>
<span class="line"><span>   &quot;node&quot;: &quot;14.x || 16.x&quot;,</span></span>
<span class="line"><span>   &quot;npm&quot;: &quot;&gt;=6.14.18&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>配置之后会发现，该字段只对 yarn 生效；</p><p>那如何对 npm 也生效呢？在项目根目录下的 .npmrc 文件中增加如下配置</p><p>.npmrc</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>engine-strict = true</span></span></code></pre></div><p>以上配置完成后，执行 npm install，不匹配的 Node.js 版本将直接退出。</p><h2 id="锁定包管理器" tabindex="-1">锁定包管理器 <a class="header-anchor" href="#锁定包管理器" aria-label="Permalink to &quot;锁定包管理器&quot;">​</a></h2><p>利用 only-allow 工具包，npm scripts 快速实现锁定。</p><ul><li><p>步骤一：在项目中安装 npm install only-allow -D</p></li><li><p>步骤二：在 package.json 文件配置 scripts.preinstall，允许输入的值有：</p></li></ul><p>only-allow npm、only-allow pnpm、only-allow yarn</p><p>package.json</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&quot;scripts&quot;: {</span></span>
<span class="line"><span>    &quot;preinstall&quot;: &quot;only-allow npm&quot;,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>以上配置完成后，可以使用 （yarn、pnpm） 试试，直接报错退出。</p>`,18),o=[t];function l(i,c,d,r,h,u){return s(),n("div",null,o)}const g=a(p,[["render",l]]);export{m as __pageData,g as default};
